<view class="container">
  <!-- loading çŠ¶æ€ -->
  <block wx:if="{{isLoading}}">
    <view class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </block>

  <!-- æ•°æ®åŠ è½½å®Œæ¯•åå±•ç¤ºå†…å®¹ -->
  <block wx:else>
    <!-- é¡¶éƒ¨å¡ç‰‡åŒºåŸŸ -->
    <view class="header-card">
      <view class="role-tip" wx:if="{{user_role === 'teacher'}}">
        <text class="welcome-text">ğŸ‘¨â€ğŸ« æ‚¨æ˜¯æ•™å¸ˆè§’è‰²ï¼Œæ¬¢è¿è¿›è¡Œè¯¾ç¨‹ç®¡ç†</text>
      </view>
      <view class="role-tip" wx:if="{{user_role === 'student'}}">
        <text class="welcome-text">ğŸ‘‹ {{user_name}}åŒå­¦ï¼Œæ¬¢è¿å›æ¥</text>
        <text class="sub-text">ä»Šå¤©ä¹Ÿè¦åŠªåŠ›å­¦ä¹ å“¦</text>
      </view>
    </view>

    <!-- ä½œä¸šèœå•æ  -->
    <view class="assignment-menu">
      <view class="menu-item {{selectedMenu === 'pending' ? 'active' : ''}}"
            bindtap="selectMenu" data-menu="pending">
        å¾…å®Œæˆä½œä¸š
      </view>
      <view class="menu-item {{selectedMenu === 'all' ? 'active' : ''}}"
            bindtap="selectMenu" data-menu="all">
        æ‰€æœ‰ä½œä¸š
      </view>
    </view>

    <!-- ä½œä¸šåˆ—è¡¨åŒºåŸŸ -->
    <view class="section-title">
      <text wx:if="{{selectedMenu === 'pending'}}">å¾…å®Œæˆä½œä¸š(è¯·åˆ°ç”µè„‘ç«¯æäº¤ä½œä¸š)</text>
      <text wx:else>æ‰€æœ‰ä½œä¸š</text>
    </view>
    <view class="link" wx:if="{{selectedMenu === 'pending'}}">
      ç½‘å€ï¼ˆè½»ç‚¹å¤åˆ¶ï¼‰ï¼š<text selectable bindtap="copyUrl">https://www.001ai.top</text>
    </view>
    <view class="assignments-container">
      <view class="assignment-card" wx:for="{{selectedMenu === 'pending' ? assignments_to_do : assignments}}" wx:key="assignment_id">
        <view class="assignment-header">
          <text class="assignment-title">{{item.title}}</text>
          <text class="assignment-id">#{{item.assignment_id}}</text>
        </view>
        <text class="assignment-desc">{{item.description}}</text>
        <view class="assignment-footer">
          <view class="course-tag">{{item.course_id}}</view>
          <text class="deadline">æˆªæ­¢æ—¥æœŸ: {{item.deadline}}</text>
        </view>
      </view>
      <view class="no-assignment" wx:if="{{(selectedMenu === 'pending' && !assignments_to_do.length) || (selectedMenu === 'all' && !assignments.length)}}">
        <text>ğŸ‰ å½“å‰æš‚æ— ä½œä¸šä¿¡æ¯</text>
      </view>
    </view>

    <!-- è¯¾ç¨‹åˆ—è¡¨åŒºåŸŸï¼ˆä»…å­¦ç”Ÿå±•ç¤ºï¼‰ -->
    <view class="section-title" wx:if="{{user_role === 'student'}}">æˆ‘çš„è¯¾ç¨‹</view>
    <view class="course-list" wx:if="{{user_role === 'student' && courses.length > 0}}">
      <view class="course-item" 
            wx:for="{{courses}}" 
            wx:key="course_id" 
            bindtap="goToCourseDetail" 
            data-course_id="{{item.course_id}}"
            hover-class="course-item-hover">
        <view class="course-header">
          <text class="course-name">{{item.course_name}}</text>
          <text class="course-id">{{item.course_id}}</text>
        </view>
        <text class="course-description">{{item.description}}</text>
        <view class="teacher-info">
          <image class="teacher-avatar" src="/assets/teacher-avatar.png" mode="aspectFill"></image>
          <view class="teacher-detail">
            <text class="teacher-label">æˆè¯¾æ•™å¸ˆ</text>
            <text class="teacher-name">{{item.teacher}}</text>
          </view>
        </view>
      </view>
    </view>
    <view class="no-course-tip" wx:if="{{user_role === 'student' && courses.length === 0}}">
      <image class="empty-image" src="/assets/empty-courses.png" mode="aspectFit"></image>
      <text>æš‚æ— è¯¾ç¨‹ä¿¡æ¯</text>
      <text class="sub-tip">å¯ä»¥è”ç³»æ•™å¸ˆæ·»åŠ è¯¾ç¨‹</text>
    </view>
  </block>
</view>
